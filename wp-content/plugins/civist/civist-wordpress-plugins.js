(window.civistJsonp=window.civistJsonp||[]).push([[8],{442:function(e,n,t){"use strict";var a,r,c={kind:"Request",fragment:{kind:"Fragment",name:"reconnectTenantMutation",type:"Mutation",metadata:null,argumentDefinitions:a=[{kind:"LocalArgument",name:"input",type:"reconnectTenantInput!",defaultValue:null}],selections:r=[{kind:"LinkedField",alias:null,name:"reconnectTenant",storageKey:null,args:[{kind:"Variable",name:"input",variableName:"input",type:"reconnectTenantInput!"}],concreteType:"reconnectTenantPayload",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"apiKey",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"apiKeyId",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"apiUrl",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"oEmbedUrl",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"widgetUrl",args:null,storageKey:null}]}]},operation:{kind:"Operation",name:"reconnectTenantMutation",argumentDefinitions:a,selections:r},params:{operationKind:"mutation",name:"reconnectTenantMutation",id:null,text:"mutation reconnectTenantMutation(\n  $input: reconnectTenantInput!\n) {\n  reconnectTenant(input: $input) {\n    apiKey\n    apiKeyId\n    apiUrl\n    oEmbedUrl\n    widgetUrl\n  }\n}\n",metadata:{}}};c.hash="dc5a6f7cce5303bdee0139c18f6a1798",e.exports=c},857:function(e,n,t){t(67),t(148),t(158),t(159),t(160),t(161),t(162),e.exports=t(896)},896:function(e,n,t){"use strict";t.r(n);var a,r=t(0),c=t.n(r),i=t(20),o=t(147),l=t(93),s=t(6),u=t.n(s),d=t(58),m=t.n(d),p=t(10),g=t.n(p),f=t(11),h=t.n(f),w=t(13),b=t.n(w),v=t(12),y=t.n(v),T=t(5),E=t.n(T),M=t(14),k=t.n(M),x=t(2),S=t.n(x),F=t(3),K=t(17),R=t(45),I=t(9),U=function(){var e=t(442);return e.hash&&"dc5a6f7cce5303bdee0139c18f6a1798"!==e.hash&&console.error("The definition of 'reconnectTenantMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),t(442)},C=function(e,n,t){return Object(I.commitMutation)(e,u()({mutation:U,variables:{input:{clientMutationId:0,apiKeyId:n.apiKeyId,pluginLanguage:n.pluginLanguage,source:n.source,verificationTargetUrl:n.verificationTargetUrl}}},t))},j=t(204),O=t(16),B=t(53),L=Object(B.a)(B.c.urlMiddleware({url:"".concat(O.b,"mgmt/graphql")})),P=Object(F.defineMessages)({title:{id:"wp.reconnect.title",description:"The title of the reconnect screen.",defaultMessage:"Reconnect Civist"},text:{id:"wp.reconnect.confirm.text",description:"The text of the reconnect screen when the user has to confirm.",defaultMessage:"This will reconfigure the Civist plugin and no data will be lost but you will have to click the verification link in the email that will be sent to the address used in the registration."},submitButton:{id:"wp.reconnect.confirm.button.label",description:"The label of the reconnect button in the reconnect screen when the user has to confirm.",defaultMessage:"Reconnect"},reconnecting:{id:"wp.reconnect.reconnecting.text",description:"The text of the reconnect screen when it is reconnecting.",defaultMessage:"Reconnecting..."},success:{id:"wp.reconnect.sucess.text",description:"The text of the reconnect screen when it reconnected successfully.",defaultMessage:"Success! Please check your inbox and click the verification link."},error:{id:"wp.reconnect.error.text",description:"The text of the reconnect screen when it failed reconnecting.",defaultMessage:"Something went wrong. Please reload and try reconnecting again."},reloadButton:{id:"wp.reconnect.error.button.label",description:"The label of the reload button in the reconnect screen when it failed reconnecting.",defaultMessage:"Reload"}}),q={confirm:"confirm",reconnecting:"reconnecting",success:"success",error:"error"},A=(a={},S()(a,q.confirm,{confirm:q.reconnecting}),S()(a,q.reconnecting,{success:q.success,failure:q.error}),S()(a,q.success,null),S()(a,q.error,null),a),D=function(e,n){return A[e][n]},J=function(e){function n(){var e,t;g()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return t=b()(this,(e=y()(n)).call.apply(e,[this].concat(r))),S()(E()(t),"state",{state:q.confirm}),S()(E()(t),"onReconnectTenantSuccess",function(e){var n=e.reconnectTenant;t.persistPluginSettings(n)}),S()(E()(t),"onFailure",function(){t.setState(function(e){var n=e.state;return{state:D(n,"failure")}})}),S()(E()(t),"onConfirm",function(){t.setState(function(e){var n=e.state;return{state:D(n,"confirm")}},t.reconnectTenant)}),S()(E()(t),"reconnectTenant",function(){C(L,{source:window.location.href,pluginLanguage:O.w,verificationTargetUrl:"".concat(O.v,"?page=").concat(O.j),apiKeyId:O.a},{onCompleted:t.onReconnectTenantSuccess,onError:t.onFailure})}),S()(E()(t),"persistPluginSettings",function(){var e=m()(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.wpSettings.setSettings(u()({},a,{nonce:O.m}));case 3:t.setState(function(e){var n=e.state;return{state:D(n,"success")}}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t.onFailure();case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(n){return e.apply(this,arguments)}}()),t}return k()(n,e),h()(n,[{key:"render",value:function(){return c.a.createElement(R.a,null,c.a.createElement(R.c,null,c.a.createElement(F.FormattedMessage,P.title)),this.state.state===q.confirm?c.a.createElement("div",null,c.a.createElement(R.b,null,c.a.createElement(F.FormattedMessage,P.text)),c.a.createElement(K.b,{onClick:this.onConfirm,primary:!0,hero:!0},c.a.createElement(F.FormattedMessage,P.submitButton))):null,this.state.state===q.reconnecting?c.a.createElement(R.b,null,c.a.createElement(F.FormattedMessage,P.reconnecting)):null,this.state.state===q.success?c.a.createElement(R.b,null,c.a.createElement(F.FormattedMessage,P.success)):null,this.state.state===q.error?c.a.createElement("div",null,c.a.createElement(R.b,null,c.a.createElement(F.FormattedMessage,P.error)),c.a.createElement(K.b,{onClick:function(){return window.location.reload()},primary:!0,hero:!0},c.a.createElement(F.FormattedMessage,P.reloadButton))):null)}}]),n}(r.Component);S()(J,"wpSettings",new j.a("".concat(O.t,"?action=").concat(O.p))),J.propTypes={};var V=J,$=t(141),N=Object(o.a)(Object(o.b)(c.a.createElement(function(){return c.a.createElement(l.a,null,c.a.createElement(i.Switch,null,c.a.createElement(i.Route,{path:"/",component:V}),c.a.createElement(i.Route,{component:$.a})))},null)));t(163),t(65);window.document.getElementById(O.l).onclick=function(){N.open()}}},[[857,0,2,1]]]);