window.WebARX=window.WebARX||{},function(e,a,r,t){var n={};t.init=function(){t.cache(),t.bindEvents()},t.cache=function(){n.window=r(e),n.body=r(a.body)},t.bindEvents=function(){r("#webarx-activate-license").on("click",function(){var e=r("#webarx_api_client_id").val(),a=r("#webarx_api_client_secret_key").val(),t={action:"activate_license",clientid:e,secretkey:a,WebarxNonce:WebarxVars.nonce};return 0==r.trim(e).length?(alert("Please enter the API Client ID!"),!1):0==r.trim(a).length?(alert("Please enter the API Client Secret Key!"),!1):void r.post(WebarxVars.ajaxurl,t,function(e){var a=r.parseJSON(e);"error"==a.result?alert(WebarxVars.error_message):(r("#hiddenstatusbox").show(),r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").hide(),r("#webarx-deactivate-license").show(),r("#webarx-test-api").show())})}),r("#webarx-deactivate-license").on("click",function(){var e=r("#webarx_api_client_id").val(),a=r("#webarx_api_client_secret_key").val(),t={action:"deactivate_license",clientid:e,secretkey:a,WebarxNonce:WebarxVars.nonce};return 0==r.trim(e).length?(alert("Please enter the API Client ID!"),!1):0==r.trim(a).length?(alert("Please enter the API Client Secret Key!"),!1):void r.post(WebarxVars.ajaxurl,t,function(e){var a=r.parseJSON(e);"error"==a.result?alert(WebarxVars.error_message):(r("#hiddenstatusbox").show(),r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").show(),r("#webarx-deactivate-license").hide(),r("#webarx-test-api").hide())})}),r("#webarx-test-api").on("click",function(){var e={action:"test_api",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){var a=r.parseJSON(e);r("#hiddenstatusbox").show(),"success"==a.result?r("#webarx_license_key_result").text("API connected successfully!"):r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").hide(),r("#webarx-deactivate-license").show(),r("#webarx-test-api").show()})}),r("#webarx_send_mail_url").on("click",function(){var e={action:"send_new_url_email",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):alert("Email Sent!")})}),void 0!==jQuery.fn.dataTable&&-1!==e.location.href.indexOf("webarx")&&(r(".table-firewall-log").DataTable({processing:!0,serverSide:!0,ajax:{url:WebarxVars.ajaxurl,type:"POST",data:function(e){e.action="firewall_log_table",e.WebarxNonce=r("meta[name=webarx_nonce]").attr("value")}},responsive:!0,columns:[{data:"fid"},{data:"fid"},{data:"referer"},{data:"method"},{data:"ip",render:r.fn.dataTable.render.text()},{data:"log_date"}],order:[[0,"desc"]],searching:!1,ordering:!1,drawCallback:function(e){r(".titletip").tooltip()},columnDefs:[{render:function(e,a,r){for(var t="low",n=["xss","csrf","xsrf"],i=0;i<n.length;i++)-1!==String(r.fid).toLowerCase().indexOf(n[i])&&(t="medium");var s=["sqli","lfi","rfe","id","files"];for(i=0;i<s.length;i++)-1!==String(r.fid).toLowerCase().indexOf(s[i])&&(t="high");var l="blue";return"medium"===t&&(l="orange"),"high"===t&&(l="red"),'<small style="color: '+l+'">'+t.toUpperCase()+"</small>"},targets:0},{render:function(e,a,r){var t=e||"Unknown";return'<span class=" titletip" title="'+(r.description?r.description:"No Explanation")+'">'+t+"</span>"},targets:1},{render:function(e,a,r){return decodeURIComponent(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("+"," ")},targets:[2]}]}),r(".table-user-log").DataTable({processing:!0,serverSide:!0,ajax:{url:WebarxVars.ajaxurl,type:"POST",data:function(e){e.action="users_log_table",e.WebarxNonce=r("meta[name=webarx_nonce]").attr("value")}},responsive:!0,columns:[{data:"author"},{data:"action",render:r.fn.dataTable.render.text()},{data:"object",render:r.fn.dataTable.render.text()},{data:"object_name",render:r.fn.dataTable.render.text()},{data:"ip",render:r.fn.dataTable.render.text()},{data:"date",render:r.fn.dataTable.render.text()}],order:[[0,"desc"]],searching:!0,ordering:!1,columnDefs:[{render:function(e,a,r){return"18.220.89.14"==r.ip?"WebARX API":e},targets:[0,4]}]}))},r(t.init)}(window,document,jQuery,window.WebARX);